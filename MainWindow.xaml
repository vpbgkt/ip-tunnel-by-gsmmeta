<Window x:Class="IPTunnelGsmMeta.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IPTunnelGsmMeta"
        mc:Ignorable="d"
        Title="GsmMeta Server" 
        Height="540" Width="360"
        MinHeight="500" MinWidth="350"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="{StaticResource BackgroundBrush}"
        Icon="logo.png">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/> <!-- Top Content -->
            <RowDefinition Height="Auto"/> <!-- Footer -->
        </Grid.RowDefinitions>

        <TabControl x:Name="MainTabControl">
            
            <!-- CONNECTION TAB -->
            <TabItem Header="Connection">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/> 
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Hero Section -->
                    <StackPanel Grid.Row="0" VerticalAlignment="Center" HorizontalAlignment="Center">
                        
                        <!-- Status Circle -->
                        <Border Width="110" Height="110" CornerRadius="55" 
                                Background="{StaticResource SurfaceBrush}" Margin="0,0,0,25">
                            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Ellipse x:Name="StatusIndicator" Width="24" Height="24" Fill="Gray"/>
                            </Grid>
                        </Border>
                        
                        <!-- Status Text -->
                        <TextBlock x:Name="StatusText" Text="Disconnected" 
                                   Foreground="{StaticResource TextBrush}" 
                                   FontSize="22" FontWeight="Bold" 
                                   HorizontalAlignment="Center" Margin="0,0,0,5"/>
                         
                         <!-- Uptime -->
                         <TextBlock x:Name="UptimeText" Text="Ready to connect" 
                                   Foreground="{StaticResource SubTextBrush}" 
                                   HorizontalAlignment="Center" Margin="0,0,0,35"/>

                        <!-- Big Connect Button -->
                        <Button x:Name="ToggleButton" Content="CONNECT" Height="50" Width="200" 
                                Click="ToggleButton_Click" FontSize="16"/>
                        
                        <!-- Logs Button (Link Style) -->
                         <Button Content="View System Logs" Click="ViewLogsButton_Click" Background="Transparent" 
                                 Foreground="{StaticResource SubTextBrush}" Margin="0,15,0,0" BorderThickness="0" Cursor="Hand" FontSize="12"/>
                    </StackPanel>

                    <!-- Auto Connect (Bottom of Tab) -->
                    <StackPanel Grid.Row="1" VerticalAlignment="Bottom" Margin="0,10,0,10">
                         <CheckBox x:Name="AutoConnectCheckbox" Content="Auto-connect on startup" 
                                   HorizontalAlignment="Center" Foreground="{StaticResource SubTextBrush}"
                                   Checked="AutoConnectCheckbox_Changed" Unchecked="AutoConnectCheckbox_Changed"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- SETTINGS TAB -->
            <TabItem Header="Settings">
                <StackPanel Margin="5">
                    
                    <!-- SSH Key -->
                    <TextBlock Text="Authentication" FontWeight="Bold" Margin="0,0,0,10"/>
                    <Border Background="{StaticResource SurfaceBrush}" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock x:Name="KeyStatusText" Text="No SSH keys found" Foreground="{StaticResource SubTextBrush}" FontSize="12" Margin="0,0,0,12"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="10"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <!-- Generate Button -->
                                <Button Grid.Column="0" x:Name="GenerateKeyButton" Content="Generate Key" 
                                        Click="GenerateKeyButton_Click" FontSize="12" Padding="0,8" 
                                        Style="{StaticResource SecondaryButton}"/>
                                
                                <!-- Copy Button -->
                                <Button Grid.Column="2" x:Name="CopyKeyButton" Content="Copy Key" 
                                        Click="CopyKeyButton_Click" IsEnabled="False" FontSize="12" Padding="0,8" 
                                        Style="{StaticResource SecondaryButton}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Server Command -->
                    <TextBlock Text="Server Configuration" FontWeight="Bold" Margin="0,0,0,10"/>
                     <Border Background="{StaticResource SurfaceBrush}" CornerRadius="8" Padding="15">
                        <StackPanel>
                            <TextBlock Text="Connection Command" Foreground="{StaticResource SubTextBrush}" FontSize="12" Margin="0,0,0,8"/>
                            <TextBox x:Name="ServerCommandTextBox" Height="80" TextWrapping="Wrap" AcceptsReturn="True" 
                                     Text="ssh -4 -N -R ..." VerticalScrollBarVisibility="Auto" Margin="0,0,0,15"
                                     FontFamily="Consolas, Courier New, Monospace" FontSize="12"/>
                            
                            <Button Content="Save Configuration" Click="SaveConfigButton_Click"/>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </TabItem>
        </TabControl>

        <!-- Footer -->
        <StackPanel Grid.Row="1" Margin="0,10,0,0" HorizontalAlignment="Center">
             <TextBlock FontSize="11" Foreground="{StaticResource SubTextBrush}" HorizontalAlignment="Center" Opacity="0.7">
                 <Run Text="GsmMeta Server v2.0"/>
             </TextBlock>
             <TextBlock FontSize="11" HorizontalAlignment="Center" Margin="0,2,0,0">
                <Hyperlink NavigateUri="https://gsmmeta.com" RequestNavigate="Hyperlink_RequestNavigate" Foreground="{StaticResource SubTextBrush}" TextDecorations="None">
                    gsmmeta.com
                </Hyperlink>
            </TextBlock>
             <!-- Hidden Status Bar Text for C# Logic Compatibility -->
            <TextBlock x:Name="StatusBarText" Visibility="Collapsed"/>
        </StackPanel>
    </Grid>
</Window>
